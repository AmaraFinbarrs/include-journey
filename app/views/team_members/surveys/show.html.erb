<main class="container team-members surveys show">
  <section class="row">
    <div class="col">
      <h2><%= @survey.name %></h2>
      <% @survey_sections.each do |section| %>
        <div class="container survey-section">
          <% unless section.survey_questions.count.zero? %>
            <div class="row table-header">
              <div class="col-12 col-lg-6"></div>
              <% 6.times do |index| %>
                <div class="col-2 col-lg-1"><div class="header-text"><%= survey_option(index) %></div></div>
              <% end %>
            </div>

            <% section.survey_questions.includes(:survey_answers).order(order: :asc).each do |question| %>
              <div class="row">
                <div class="col-12 col-lg-6"><%= question.question %></div>
                <% total_answers = question.survey_answers.count %>
                <% 6.times do |index| %>
                  <% answer_count = question.survey_answers.where(answer: index).count %>
                  <% answer_pct = (answer_count.to_f / total_answers) * 100 %>
                  <div class="col-2 col-lg-1" data-toggle="tooltip" data-placement="bottom"
                       title="<%= answer_count %> [<%= answer_pct %>%]">
                    <div class="progress">
                      <div class="progress-bar progress-bar-striped bg-success" role="progressbar"
                           style="width: <%= answer_pct %>%" aria-valuenow="<%= answer_pct %>"
                           aria-valuemin="0" aria-valuemax="100"></div>
                    </div>
                  </div>
                <% end %>
              </div>
            <% end %>
          <% end %>
        </div>
      <% end %>
    </div>
  </section>
</main>
